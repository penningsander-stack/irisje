<!-- frontend/register.html -->
<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Account aanmaken – Irisje.nl</title>
  <link rel="stylesheet" href="/style.css?v=20260113">
</head>

<body class="irisje-body">

<header class="irisje-header sticky top-0 z-40">
  <div class="max-w-6xl mx-auto px-4 py-3 lg:py-4 flex justify-between items-center">
    <a href="/" class="flex items-center space-x-2">
      <span class="inline-flex items-center justify-center w-9 h-9 rounded-2xl bg-white/90
                   text-indigo-700 text-sm font-bold shadow-brand">I</span>
      <div class="flex flex-col leading-tight">
        <span class="font-semibold text-slate-900 tracking-tight">Irisje.nl</span>
        <span class="text-[11px] text-slate-500">Zakelijk account</span>
      </div>
    </a>

    <a href="login.html" class="text-sm text-slate-600 hover:text-slate-900">
      Inloggen
    </a>
  </div>
</header>

<main class="onboarding max-w-6xl mx-auto px-4 py-12 lg:py-16">
  <div class="grid lg:grid-cols-2 gap-12 items-start">

    <!-- Left -->
    <section class="hidden lg:block">
      <div class="rounded-3xl p-9 bg-white/70 backdrop-blur border border-white/60 shadow-brand">
        <h1 class="text-3xl font-semibold tracking-tight text-slate-900">
          Zet je bedrijf professioneel online
        </h1>
        <p class="mt-4 text-slate-600 leading-relaxed">
          Maak eerst een account aan. Daarna vul je je bedrijfsprofiel in en
          ontvang je aanvragen van klanten.
        </p>
      </div>
    </section>

    <!-- Right -->
    <section>
      <div class="max-w-md mx-auto">
        <div class="mb-8">
          <div class="text-xs font-semibold text-slate-500 tracking-wide uppercase mb-2">
            Stap 1 van 2
          </div>
          <h2 class="text-2xl font-semibold tracking-tight text-slate-900">
            Account aanmaken
          </h2>
        </div>

        <div class="card rounded-3xl bg-white/85 backdrop-blur border border-white/60 shadow-brand">
          <form id="registerForm" class="space-y-7" novalidate>

            <div class="field">
              <input id="regName" type="text" name="name" required placeholder=" " autocomplete="name">
              <label for="regName">Naam (persoon of bedrijf)</label>
              <p class="field-msg"></p>
            </div>

            <div class="field">
              <input id="regEmail" type="email" name="email" required placeholder=" " autocomplete="email">
              <label for="regEmail">E-mailadres</label>
              <p class="field-msg"></p>
            </div>

            <div class="field">
              <input id="regPassword" type="password" name="password" required minlength="8" placeholder=" " autocomplete="new-password">
              <label for="regPassword">Wachtwoord (min. 8 tekens)</label>
              <p class="field-msg"></p>
            </div>

            <p id="registerStatus" class="rq-status min-h-[1.25rem]"></p>

            <div class="pt-2">
              <button type="submit" class="btn-primary w-full py-3">
                Account aanmaken
              </button>
            </div>

            <p class="text-xs text-slate-500 leading-relaxed pt-2">
              Door een account aan te maken ga je akkoord met onze
              <a href="terms.html" class="text-indigo-600 hover:underline">voorwaarden</a>
              en
              <a href="privacy.html" class="text-indigo-600 hover:underline">privacyverklaring</a>.
            </p>

          </form>

          <div class="mt-8 pt-6 border-t border-slate-200 flex items-center justify-between">
            <span class="text-sm text-slate-600">Heb je al een account?</span>
            <a href="login.html" class="text-sm font-semibold text-indigo-600 hover:underline">Inloggen</a>
          </div>
        </div>
      </div>
    </section>

  </div>
</main>

<script>
const API_BASE = "https://irisje-backend.onrender.com/api";

function setHint(el, msg) { el.textContent = msg; el.className = "text-xs text-slate-400 mt-1"; }
function setError(el, msg) { el.textContent = msg; el.className = "text-xs text-red-600 mt-1"; }
function clearMsg(el) { el.textContent = ""; el.className = "text-xs mt-1"; }

function wireEmail(input) {
  const msg = input.parentElement.querySelector(".field-msg");
  input.addEventListener("focus", () => setHint(msg, "Gebruik het e-mailadres waarmee je je registreert."));
  input.addEventListener("blur", () => {
    if (!input.value) return clearMsg(msg);
    if (!input.checkValidity()) setError(msg, "Dit lijkt geen geldig e-mailadres.");
    else clearMsg(msg);
  });
}

function wirePassword(input) {
  const msg = input.parentElement.querySelector(".field-msg");
  input.addEventListener("focus", () => setHint(msg, "Minimaal 8 tekens."));
  input.addEventListener("blur", () => {
    if (!input.value) return clearMsg(msg);
    if (input.value.length < 8) setError(msg, "Wachtwoord moet minimaal 8 tekens zijn.");
    else clearMsg(msg);
  });
}

function wireName(input) {
  const msg = input.parentElement.querySelector(".field-msg");
  input.addEventListener("focus", () => setHint(msg, "Bijv. je bedrijfsnaam of je eigen naam."));
  input.addEventListener("blur", () => {
    if (!input.value) return clearMsg(msg);
    if (input.value.trim().length < 2) setError(msg, "Vul minimaal 2 tekens in.");
    else clearMsg(msg);
  });
}

const nameEl = document.getElementById("regName");
const emailEl = document.getElementById("regEmail");
const passEl  = document.getElementById("regPassword");

wireName(nameEl);
wireEmail(emailEl);
wirePassword(passEl);

document.getElementById("registerForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const status = document.getElementById("registerStatus");
  status.textContent = "";

  const payload = {
    name: (nameEl.value || "").trim(),
    email: (emailEl.value || "").trim(),
    password: passEl.value || ""
  };

  // Frontend checks (inline, geen alerts)
  let ok = true;

  if (!payload.name || payload.name.length < 2) {
    setError(nameEl.parentElement.querySelector(".field-msg"), "Vul minimaal 2 tekens in.");
    ok = false;
  }

  if (!emailEl.checkValidity()) {
    setError(emailEl.parentElement.querySelector(".field-msg"), "Dit lijkt geen geldig e-mailadres.");
    ok = false;
  }

  if (!payload.password || payload.password.length < 8) {
    setError(passEl.parentElement.querySelector(".field-msg"), "Wachtwoord moet minimaal 8 tekens zijn.");
    ok = false;
  }

  if (!ok) {
    status.textContent = "Controleer de velden hierboven.";
    return;
  }

  status.textContent = "Account aanmaken…";

  try {
    const res = await fetch(`${API_BASE}/auth/register`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    const data = await res.json().catch(() => ({}));
    if (!res.ok) {
      status.textContent = data.message || "Registratie mislukt.";
      return;
    }

    window.location.href = "register-company.html";
  } catch (err) {
    status.textContent = "Er ging iets mis. Probeer later opnieuw.";
  }
});
</script>

</body>
</html>
