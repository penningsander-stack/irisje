<!-- frontend/results.html -->
<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <title>Zoekresultaten – Irisje.nl</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <header>
    <a href="./index.html">← Terug</a> &nbsp; Zoekresultaten
  </header>
  <main>
    <h1>Resultaten</h1>
    <div id="results"></div>
  </main>
  <footer>© 2025 Irisje.nl</footer>

  <script>
    const API = "https://irisje-backend.onrender.com/api";
    function starRow(avg) {
      const n = Math.round(Number(avg) || 0);
      let s = "";
      for (let i = 0; i < 5; i++) s += i < n ? "⭐" : "☆";
      return s + (avg ? ` (${avg})` : "");
    }
    async function load() {
      const p = new URLSearchParams(window.location.search);
      const q = p.get("q") || "";
      const city = p.get("city") || "";
      const url = `${API}/companies/search?q=${encodeURIComponent(q)}&city=${encodeURIComponent(city)}&limit=20`;
      const res = await fetch(url);
      const data = await res.json();
      const box = document.getElementById("results");
      box.innerHTML = "";
      if (!data.ok || !data.items || data.items.length === 0) {
        box.innerHTML = "<p>Geen resultaten gevonden.</p>";
        return;
      }
      for (const c of data.items) {
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `
          <h3>${c.name} ${c.isVerified ? "✔️" : ""}</h3>
          <p>${starRow(c.avgRating)} • ${c.reviewCount || 0} reviews</p>
          <p>${c.tagline || ""}</p>
          <p>${c.city || ""} • ${Array.isArray(c.categories) ? c.categories.join(", ") : ""}</p>
          <p><a href="company.html?slug=${encodeURIComponent(c.slug)}">Bekijk profiel →</a></p>
        `;
        box.appendChild(div);
      }
    }
    load();
  </script>
</body>
</html>
