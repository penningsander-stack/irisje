<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <title>Admin – Irisje</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Beheer – Irisje</h1>
  </header>

  <main>
    <div id="companyList"></div>
  </main>

  <script>
    const API_BASE_URL = 'https://irisje.onrender.com';

    async function fetchCompanies() {
      const res = await fetch(`${API_BASE_URL}/api/companies`);
      const companies = await res.json();
      const list = document.getElementById('companyList');
      list.innerHTML = '';

      companies.forEach(company => {
        const div = document.createElement('div');
        div.innerHTML = `
          <h2>${company.name}</h2>
          <p>${company.category} – ${company.location}</p>
          <p>${company.description}</p>
          <button onclick="deleteCompany('${company._id}')">Verwijderen</button>
          <button onclick="editCompany('${company._id}')">Bewerken</button>
          <div id="edit-${company._id}" style="display:none;">
            <input id="name-${company._id}" value="${company.name}" />
            <input id="category-${company._id}" value="${company.category}" />
            <input id="location-${company._id}" value="${company.location}" />
            <textarea id="description-${company._id}">${company.description}</textarea>
            <button onclick="saveCompany('${company._id}')">Opslaan</button>
          </div>
        `;
        list.appendChild(div);
      });
    }

    function editCompany(id) {
      document.getElementById(`edit-${id}`).style.display = 'block';
    }

    async function saveCompany(id) {
      const name = document.getElementById(`name-${id}`).value;
      const category = document.getElementById(`category-${id}`).value;
      const location = document.getElementById(`location-${id}`).value;
      const description = document.getElementById(`description-${id}`).value;

      await fetch(`${API_BASE_URL}/api/companies/${id}`, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name, category, location, description })
      });

      fetchCompanies();
    }

    async function deleteCompany(id) {
      if (confirm('Weet je zeker dat je dit bedrijf wilt verwijderen?')) {
        await fetch(`${API_BASE_URL}/api/companies/${id}`, { method: 'DELETE' });
        fetchCompanies();
      }
    }

    fetchCompanies();
  </script>
</body>
</html>
